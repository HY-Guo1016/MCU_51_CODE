C51 COMPILER V9.60.0.0   MAIN                                                              02/10/2023 23:36:40 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\Output\main.obj
COMPILER INVOKED BY: d:\Keil_v5\C51\BIN\C51.EXE ..\Source\main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(..\Li
                    -stings\main.lst) OBJECT(..\Output\main.obj)

line level    source

   1          #include <reg51.h>
   2          #include <intrins.h>
   3          
   4          sbit PWM_LED = P2^2;
   5          void Timer0Init();
   6          void EX0_init();
   7          void Delay1000ms();
   8          unsigned char PWM_pro = 0;
   9          unsigned char PWM_cnt = 100;
  10          unsigned char key_cnt = 0;
  11          void main()
  12          {
  13   1              Timer0Init();
  14   1              EX0_init();
  15   1              while(1)
  16   1              {
  17   2                      
  18   2              }
  19   1      }
  20          
  21          
  22          void Timer0Init(void)           //100微秒@11.0592MHz
  23          {
  24   1              TMOD &= 0xF0;           //设置定时器模式
  25   1              TMOD |= 0x01;           //设置定时器模式
  26   1              TL0 = 0xA4;             //设置定时初始值
  27   1              TH0 = 0xFF;             //设置定时初始值
  28   1              TF0 = 0;                //清除TF0标志
  29   1              ET0 = 1;
  30   1              EA = 1;
  31   1              TR0 = 1;
  32   1      }
  33          
  34          void timer0_ISR(void) interrupt 1
  35          {
  36   1              TR0 = 0;
  37   1              PWM_cnt--;
  38   1              if(PWM_cnt == 0)
  39   1              {
  40   2                      PWM_cnt = 100;//定时10毫秒
  41   2              }
  42   1              
  43   1              
  44   1              if(PWM_cnt >= PWM_pro)
  45   1              {
  46   2                      PWM_LED = 1;
  47   2              }
  48   1              else
  49   1              {
  50   2                      PWM_LED = 0;
  51   2              }
  52   1              TL0 = 0xA4;             //设置定时初始值
  53   1              TH0 = 0xFF;             //设置定时初始值
  54   1              TR0 = 1;
C51 COMPILER V9.60.0.0   MAIN                                                              02/10/2023 23:36:40 PAGE 2   

  55   1      }
  56          
  57          void EX0_init()
  58          {
  59   1              EX1 = 1;
  60   1      }
  61          
  62          void EX1_ISR(void) interrupt 2
  63          {
  64   1              Delay1000ms();
  65   1      
  66   1              key_cnt++;
  67   1              if(key_cnt > 6)
  68   1                      key_cnt = 0;
  69   1              switch(key_cnt)
  70   1              {
  71   2                      case 1:PWM_pro = 0;break;
  72   2                      case 2:PWM_pro = 20;break;
  73   2                      case 3:PWM_pro = 40;break;
  74   2                      case 4:PWM_pro = 60;break;
  75   2                      case 5:PWM_pro = 80;break;
  76   2                      case 6:PWM_pro = 100;break;
  77   2                      default:break;
  78   2              }
  79   1      
  80   1      }
  81          void Delay1000ms()              //@11.0592MHz
  82          {
  83   1              unsigned char i, j, k;
  84   1      
  85   1              _nop_();
  86   1              i = 8;
  87   1              j = 1;
  88   1              k = 243;
  89   1              do
  90   1              {
  91   2                      do
  92   2                      {
  93   3                              while (--k);
  94   3                      } while (--j);
  95   2              } while (--i);
  96   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    212    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
